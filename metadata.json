{
  "version": 2,
  "tables": [
    {
      "table": {
        "schema": "anonymous",
        "name": "activist_actions"
      },
      "select_permissions": [
        {
          "role": "anonymous",
          "permission": {
            "columns": [
              "action_created_at",
              "id",
              "action",
              "mobilization_id"
            ],
            "filter": {},
            "allow_aggregations": true
          }
        },
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "mobilization_id",
              "action",
              "action_created_at"
            ],
            "filter": {},
            "allow_aggregations": true
          }
        }
      ]
    },
    {
      "table": {
        "schema": "anonymous",
        "name": "communities"
      },
      "select_permissions": [
        {
          "role": "anonymous",
          "permission": {
            "columns": [
              "id",
              "name",
              "city",
              "created_at",
              "image",
              "description",
              "fb_link",
              "twitter_link",
              "email_template_from"
            ],
            "filter": {}
          }
        },
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "description",
              "created_at",
              "city",
              "email_template_from",
              "fb_link",
              "image",
              "name",
              "twitter_link"
            ],
            "filter": {}
          }
        }
      ]
    },
    {
      "table": {
        "schema": "anonymous",
        "name": "mobilizations"
      },
      "object_relationships": [
        {
          "name": "community",
          "using": {
            "manual_configuration": {
              "remote_table": {
                "schema": "anonymous",
                "name": "communities"
              },
              "column_mapping": {
                "community_id": "id"
              }
            }
          }
        }
      ],
      "array_relationships": [
        {
          "name": "activist_actions",
          "using": {
            "manual_configuration": {
              "remote_table": {
                "schema": "anonymous",
                "name": "activist_actions"
              },
              "column_mapping": {
                "id": "mobilization_id"
              }
            }
          }
        }
      ],
      "select_permissions": [
        {
          "role": "anonymous",
          "permission": {
            "columns": [
              "community_id",
              "id",
              "user_id",
              "facebook_share_description",
              "goal",
              "created_at",
              "body_font",
              "color_scheme",
              "custom_domain",
              "facebook_share_image",
              "facebook_share_title",
              "favicon",
              "google_analytics_code",
              "header_font",
              "name",
              "slug",
              "traefik_backend_address",
              "traefik_host_rule",
              "twitter_share_text"
            ],
            "filter": {}
          }
        },
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "name",
              "created_at",
              "user_id",
              "color_scheme",
              "google_analytics_code",
              "goal",
              "facebook_share_title",
              "facebook_share_description",
              "header_font",
              "body_font",
              "facebook_share_image",
              "slug",
              "custom_domain",
              "twitter_share_text",
              "community_id",
              "favicon",
              "traefik_host_rule",
              "traefik_backend_address"
            ],
            "filter": {}
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "activist_actions"
      },
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "action_created_at",
              "activist_created_at",
              "id",
              "action",
              "widget_id",
              "mobilization_id",
              "community_id",
              "activist_id"
            ],
            "filter": {},
            "allow_aggregations": true
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "activist_pressures"
      },
      "object_relationships": [
        {
          "name": "activist",
          "using": {
            "foreign_key_constraint_on": "activist_id"
          }
        },
        {
          "name": "widget",
          "using": {
            "foreign_key_constraint_on": "widget_id"
          }
        }
      ],
      "event_triggers": [
        {
          "name": "webhook-activist-pressures",
          "definition": {
            "enable_manual": false,
            "insert": {
              "columns": "*"
            }
          },
          "retry_conf": {
            "num_retries": 0,
            "interval_sec": 10,
            "timeout_sec": 60
          },
          "webhook_from_env": "WEBHOOK_ACTIVISTS_PRESSURE_URL"
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "activists"
      }
    },
    {
      "table": {
        "schema": "public",
        "name": "chatbot_campaigns"
      },
      "object_relationships": [
        {
          "name": "chatbot",
          "using": {
            "foreign_key_constraint_on": "chatbot_id"
          }
        }
      ],
      "insert_permissions": [
        {
          "role": "common_user",
          "permission": {
            "check": {
              "chatbot": {
                "community": {
                  "community_users": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                }
              }
            },
            "columns": [
              "get_started",
              "chatbot_id",
              "id",
              "diagram",
              "status",
              "created_at",
              "updated_at",
              "name"
            ]
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "created_at",
              "updated_at",
              "id",
              "name",
              "diagram",
              "chatbot_id",
              "status",
              "get_started"
            ],
            "filter": {
              "chatbot": {
                "community": {
                  "community_users": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                }
              }
            }
          }
        }
      ],
      "update_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "created_at",
              "diagram",
              "get_started",
              "id",
              "name",
              "status",
              "updated_at"
            ],
            "filter": {
              "chatbot": {
                "community": {
                  "community_users": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                }
              }
            }
          }
        }
      ],
      "delete_permissions": [
        {
          "role": "common_user",
          "permission": {
            "filter": {
              "chatbot": {
                "community": {
                  "community_users": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                }
              }
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "chatbot_interactions"
      }
    },
    {
      "table": {
        "schema": "public",
        "name": "chatbot_settings"
      },
      "object_relationships": [
        {
          "name": "chatbot",
          "using": {
            "foreign_key_constraint_on": "chatbot_id"
          }
        }
      ],
      "insert_permissions": [
        {
          "role": "common_user",
          "permission": {
            "check": {
              "chatbot": {
                "community": {
                  "community_users": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                }
              }
            },
            "columns": [
              "created_at",
              "updated_at",
              "id",
              "channel",
              "settings",
              "chatbot_id"
            ]
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "chatbot_id",
              "id",
              "settings",
              "channel",
              "created_at",
              "updated_at"
            ],
            "filter": {
              "chatbot": {
                "community": {
                  "community_users": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                }
              }
            }
          }
        }
      ],
      "update_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "chatbot_id",
              "id",
              "settings",
              "channel",
              "created_at",
              "updated_at"
            ],
            "filter": {
              "chatbot": {
                "community": {
                  "community_users": {
                    "user_id": {
                      "_eq": "X-Hasura-User-Id"
                    }
                  }
                }
              }
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "chatbots"
      },
      "object_relationships": [
        {
          "name": "community",
          "using": {
            "foreign_key_constraint_on": "community_id"
          }
        }
      ],
      "array_relationships": [
        {
          "name": "chatbot_campaigns",
          "using": {
            "foreign_key_constraint_on": {
              "column": "chatbot_id",
              "table": {
                "schema": "public",
                "name": "chatbot_campaigns"
              }
            }
          }
        },
        {
          "name": "chatbot_settings",
          "using": {
            "foreign_key_constraint_on": {
              "column": "chatbot_id",
              "table": {
                "schema": "public",
                "name": "chatbot_settings"
              }
            }
          }
        }
      ],
      "insert_permissions": [
        {
          "role": "common_user",
          "permission": {
            "check": {
              "community": {
                "community_users": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            },
            "columns": [
              "created_at",
              "updated_at",
              "id",
              "name",
              "community_id"
            ]
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "community_id",
              "created_at",
              "id",
              "name",
              "persistent_menu",
              "updated_at"
            ],
            "filter": {
              "community": {
                "community_users": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            }
          }
        }
      ],
      "update_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "created_at",
              "id",
              "name",
              "persistent_menu",
              "updated_at"
            ],
            "filter": {
              "community": {
                "community_users": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "communities"
      },
      "object_relationships": [
        {
          "name": "recipient",
          "using": {
            "foreign_key_constraint_on": "recipient_id"
          }
        }
      ],
      "array_relationships": [
        {
          "name": "community_users",
          "using": {
            "manual_configuration": {
              "remote_table": {
                "schema": "public",
                "name": "community_users"
              },
              "column_mapping": {
                "id": "community_id"
              }
            }
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "recipient_id",
              "subscription_dead_days_interval",
              "subscription_retry_interval",
              "modules",
              "description",
              "mailchimp_api_key",
              "mailchimp_group_id",
              "mailchimp_list_id",
              "created_at",
              "mailchimp_sync_request_at",
              "updated_at",
              "city",
              "email_template_from",
              "facebook_app_id",
              "fb_link",
              "image",
              "name",
              "twitter_link"
            ],
            "filter": {
              "community_users": {
                "user_id": {
                  "_eq": "X-Hasura-User-Id"
                }
              }
            },
            "allow_aggregations": true
          }
        }
      ],
      "update_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "city",
              "created_at",
              "description",
              "email_template_from",
              "facebook_app_id",
              "fb_link",
              "id",
              "image",
              "mailchimp_api_key",
              "mailchimp_group_id",
              "mailchimp_list_id",
              "mailchimp_sync_request_at",
              "name",
              "recipient_id",
              "subscription_dead_days_interval",
              "subscription_retry_interval",
              "twitter_link",
              "updated_at"
            ],
            "filter": {
              "community_users": {
                "user_id": {
                  "_eq": "X-Hasura-User-Id"
                }
              }
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "community_users"
      },
      "object_relationships": [
        {
          "name": "user",
          "using": {
            "manual_configuration": {
              "remote_table": {
                "schema": "public",
                "name": "users"
              },
              "column_mapping": {
                "user_id": "id"
              }
            }
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "user_id",
              "community_id",
              "role",
              "created_at",
              "updated_at"
            ],
            "filter": {}
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "configurations"
      }
    },
    {
      "table": {
        "schema": "public",
        "name": "form_entries"
      },
      "event_triggers": [
        {
          "name": "pipeline-form-entries-to-redes",
          "definition": {
            "enable_manual": false,
            "insert": {
              "columns": "*"
            },
            "update": {
              "columns": [
                "synchronized",
                "activist_id",
                "cached_community_id",
                "id",
                "widget_id",
                "fields",
                "mailchimp_syncronization_error_reason",
                "created_at",
                "mailchimp_syncronization_at",
                "updated_at"
              ]
            }
          },
          "retry_conf": {
            "num_retries": 0,
            "interval_sec": 10,
            "timeout_sec": 60
          },
          "webhook": "http://pipeline-form-entries-to-redes"
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "invitations"
      },
      "object_relationships": [
        {
          "name": "community",
          "using": {
            "foreign_key_constraint_on": "community_id"
          }
        }
      ],
      "insert_permissions": [
        {
          "role": "common_user",
          "permission": {
            "check": {
              "community": {
                "community_users": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            },
            "set": {
              "user_id": "x-hasura-User-Id"
            },
            "columns": [
              "callback_url",
              "community_id",
              "email",
              "role"
            ]
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "callback_url",
              "code",
              "community_id",
              "created_at",
              "email",
              "expired",
              "expires",
              "id",
              "role",
              "updated_at",
              "user_id"
            ],
            "filter": {
              "community": {
                "community_users": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            }
          }
        }
      ],
      "event_triggers": [
        {
          "name": "webhook-invitations",
          "definition": {
            "enable_manual": false,
            "insert": {
              "columns": "*"
            }
          },
          "retry_conf": {
            "num_retries": 0,
            "interval_sec": 10,
            "timeout_sec": 60
          },
          "webhook_from_env": "WEBHOOK_INVITATIONS_URL"
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "mobilizations"
      },
      "object_relationships": [
        {
          "name": "community",
          "using": {
            "foreign_key_constraint_on": "community_id"
          }
        }
      ],
      "array_relationships": [
        {
          "name": "activist_actions",
          "using": {
            "manual_configuration": {
              "remote_table": {
                "schema": "public",
                "name": "activist_actions"
              },
              "column_mapping": {
                "id": "mobilization_id"
              }
            }
          }
        }
      ],
      "insert_permissions": [
        {
          "role": "common_user",
          "permission": {
            "check": {
              "_or": [
                {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                },
                {
                  "community": {
                    "community_users": {
                      "id": {
                        "_eq": "X-Hasura-User-Id"
                      }
                    }
                  }
                }
              ]
            },
            "columns": [
              "community_id",
              "id",
              "user_id",
              "status",
              "facebook_share_description",
              "goal",
              "created_at",
              "deleted_at",
              "updated_at",
              "body_font",
              "color_scheme",
              "custom_domain",
              "facebook_share_image",
              "facebook_share_title",
              "favicon",
              "google_analytics_code",
              "header_font",
              "name",
              "slug",
              "traefik_backend_address",
              "traefik_host_rule",
              "twitter_share_text"
            ]
          }
        }
      ],
      "select_permissions": [
        {
          "role": "anonymous",
          "permission": {
            "columns": [
              "body_font",
              "color_scheme",
              "community_id",
              "created_at",
              "custom_domain",
              "deleted_at",
              "facebook_share_description",
              "facebook_share_image",
              "facebook_share_title",
              "favicon",
              "goal",
              "google_analytics_code",
              "header_font",
              "name",
              "slug",
              "status",
              "twitter_share_text"
            ],
            "filter": {
              "_and": [
                {
                  "deleted_at": {
                    "_is_null": true
                  }
                }
              ]
            },
            "allow_aggregations": true
          }
        },
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "body_font",
              "color_scheme",
              "community_id",
              "created_at",
              "custom_domain",
              "deleted_at",
              "facebook_share_description",
              "facebook_share_image",
              "facebook_share_title",
              "favicon",
              "goal",
              "google_analytics_code",
              "header_font",
              "id",
              "name",
              "slug",
              "status",
              "traefik_backend_address",
              "traefik_host_rule",
              "twitter_share_text",
              "updated_at",
              "user_id"
            ],
            "filter": {
              "_or": [
                {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                },
                {
                  "community": {
                    "community_users": {
                      "id": {
                        "_eq": "X-Hasura-User-Id"
                      }
                    }
                  }
                }
              ]
            },
            "allow_aggregations": true
          }
        }
      ],
      "update_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "body_font",
              "color_scheme",
              "created_at",
              "custom_domain",
              "deleted_at",
              "facebook_share_description",
              "facebook_share_image",
              "facebook_share_title",
              "favicon",
              "goal",
              "google_analytics_code",
              "header_font",
              "id",
              "name",
              "slug",
              "status",
              "traefik_backend_address",
              "traefik_host_rule",
              "twitter_share_text",
              "updated_at"
            ],
            "filter": {
              "_or": [
                {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                },
                {
                  "community": {
                    "community_users": {
                      "id": {
                        "_eq": "X-Hasura-User-Id"
                      }
                    }
                  }
                }
              ]
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "notification_templates"
      }
    },
    {
      "table": {
        "schema": "public",
        "name": "notify_mail"
      },
      "event_triggers": [
        {
          "name": "webhook-mail",
          "definition": {
            "enable_manual": false,
            "insert": {
              "columns": "*"
            }
          },
          "retry_conf": {
            "num_retries": 0,
            "interval_sec": 10,
            "timeout_sec": 60
          },
          "webhook_from_env": "WEBHOOK_MAIL_URL"
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "recipients"
      },
      "object_relationships": [
        {
          "name": "community",
          "using": {
            "foreign_key_constraint_on": "community_id"
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "pagarme_recipient_id",
              "recipient",
              "community_id",
              "transfer_day",
              "transfer_enabled",
              "created_at",
              "updated_at"
            ],
            "filter": {
              "community": {
                "community_users": {
                  "user_id": {
                    "_eq": "X-Hasura-User-Id"
                  }
                }
              }
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "rede_groups"
      }
    },
    {
      "table": {
        "schema": "public",
        "name": "rede_individuals"
      },
      "object_relationships": [
        {
          "name": "group",
          "using": {
            "foreign_key_constraint_on": "rede_group_id"
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "rede_relationships"
      },
      "object_relationships": [
        {
          "name": "agent",
          "using": {
            "foreign_key_constraint_on": "user_id"
          }
        },
        {
          "name": "recipient",
          "using": {
            "foreign_key_constraint_on": "recipient_id"
          }
        },
        {
          "name": "volunteer",
          "using": {
            "foreign_key_constraint_on": "volunteer_id"
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "solidarity_matches"
      }
    },
    {
      "table": {
        "schema": "public",
        "name": "solidarity_tickets"
      },
      "event_triggers": [
        {
          "name": "solidarity-tickets",
          "definition": {
            "enable_manual": false,
            "insert": {
              "columns": "*"
            },
            "update": {
              "columns": [
                "community_id",
                "id",
                "webhooks_registry_id",
                "assignee_id",
                "group_id",
                "organization_id",
                "requester_id",
                "submitter_id",
                "ticket_id",
                "custom_fields",
                "tags",
                "cidade",
                "data_encaminhamento",
                "data_inscricao_bonde",
                "description",
                "estado",
                "link_match",
                "nome_msr",
                "nome_voluntaria",
                "raw_subject",
                "status",
                "status_acolhimento",
                "status_inscricao",
                "subject",
                "telefone",
                "created_at",
                "updated_at"
              ]
            }
          },
          "retry_conf": {
            "num_retries": 0,
            "interval_sec": 10,
            "timeout_sec": 60
          },
          "webhook": "http://webhooks-solidarity-match"
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "solidarity_users"
      }
    },
    {
      "table": {
        "schema": "public",
        "name": "tags"
      },
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "name",
              "taggings_count",
              "label",
              "kind"
            ],
            "filter": {}
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "user_tags"
      },
      "object_relationships": [
        {
          "name": "tag",
          "using": {
            "manual_configuration": {
              "remote_table": {
                "schema": "public",
                "name": "tags"
              },
              "column_mapping": {
                "tag_id": "id"
              }
            }
          }
        }
      ],
      "insert_permissions": [
        {
          "role": "common_user",
          "permission": {
            "check": {},
            "set": {
              "user_id": "x-hasura-User-Id"
            },
            "columns": [
              "created_at",
              "tag_id",
              "updated_at"
            ]
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "id",
              "user_id",
              "tag_id",
              "created_at",
              "updated_at"
            ],
            "filter": {
              "user_id": {
                "_eq": "X-Hasura-User-Id"
              }
            }
          }
        }
      ],
      "delete_permissions": [
        {
          "role": "common_user",
          "permission": {
            "filter": {
              "user_id": {
                "_eq": "X-Hasura-User-Id"
              }
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "users"
      },
      "array_relationships": [
        {
          "name": "community_users",
          "using": {
            "manual_configuration": {
              "remote_table": {
                "schema": "public",
                "name": "community_users"
              },
              "column_mapping": {
                "id": "user_id"
              }
            }
          }
        }
      ],
      "select_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "admin",
              "avatar",
              "created_at",
              "current_sign_in_at",
              "current_sign_in_ip",
              "email",
              "first_name",
              "id",
              "last_name",
              "last_sign_in_at",
              "last_sign_in_ip",
              "locale",
              "provider",
              "remember_created_at",
              "sign_in_count",
              "uid",
              "updated_at"
            ],
            "filter": {
              "id": {
                "_eq": "X-Hasura-User-Id"
              }
            }
          }
        }
      ],
      "update_permissions": [
        {
          "role": "common_user",
          "permission": {
            "columns": [
              "avatar",
              "first_name",
              "last_name",
              "locale"
            ],
            "filter": {
              "id": {
                "_eq": "X-Hasura-User-Id"
              }
            }
          }
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "webhooks_registry"
      },
      "event_triggers": [
        {
          "name": "webhooks-registry",
          "definition": {
            "enable_manual": false,
            "insert": {
              "columns": "*"
            },
            "update": {
              "columns": [
                "id",
                "data",
                "created_at",
                "updated_at",
                "service_name"
              ]
            }
          },
          "retry_conf": {
            "num_retries": 0,
            "interval_sec": 10,
            "timeout_sec": 60
          },
          "webhook": "http://zendesk"
        }
      ]
    },
    {
      "table": {
        "schema": "public",
        "name": "widgets"
      }
    }
  ],
  "remote_schemas": [
    {
      "name": "API-v2",
      "definition": {
        "url_from_env": "SCHEMA_API_V2_URL",
        "timeout_seconds": 60,
        "forward_client_headers": true
      }
    },
    {
      "name": "Auth",
      "definition": {
        "url_from_env": "SCHEMA_API_AUTH_URL",
        "timeout_seconds": 60,
        "forward_client_headers": true
      }
    }
  ]
}